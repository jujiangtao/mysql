Description: Look for mysqltest_safe_process binary in the correct place
 We put test-specific binaries in usr/lib/mysql-test/bin, but mysql-test-run.pl
 only looks for binary in the system bin directory.
 Changed to look in usr/lib/mysql-test until a more complete upstream fix is made.
Author: Lars Tangvald <lars.tangvald@oracle.com>
Bug: https://bugs.mysql.com/bug.php?id=96336
Last-Update: 2019-07-29
--- a/mysql-test/lib/My/SafeProcess.pm
+++ b/mysql-test/lib/My/SafeProcess.pm
@@ -101,7 +101,7 @@
 			     "mysqltest_safe_kill");
   } else {
     # Use mysqltest_safe_process
-    my $exe = my_find_bin($bindir,  [ "runtime_output_directory", "bin" ],
+    my $exe = my_find_bin($bindir,  [ "","runtime_output_directory", "bin" ],
                           "mysqltest_safe_process");
     push(@safe_process_cmd, $exe);
   }
--- a/mysql-test/mysql-test-run.pl
+++ b/mysql-test/mysql-test-run.pl
@@ -377,8 +377,18 @@
   print FH "# Unique id file paths\n";
   close(FH);
 
+
+  # Look for the client binaries directory
+  if ($path_client_bindir) {
+    # --client-bindir=path set on command line, check that the path exists
+    $path_client_bindir = mtr_path_exists($path_client_bindir);
+  } else {
+    $path_client_bindir =
+      mtr_path_exists(vs_config_dirs('runtime_output_directory', ''),
+                      "$bindir/bin");
+  }
   # --help will not reach here, so now it's safe to assume we have binaries
-  My::SafeProcess::find_bin($bindir);
+  My::SafeProcess::find_bin($path_client_bindir);
 
   $secondary_engine_support = ($secondary_engine_support and
                 find_secondary_engine($bindir)) ? 1 : 0 ;
